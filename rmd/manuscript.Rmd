---
Title: "Ecosystem size and complexity are extrinsic drivers of food chain length in branching networks"
output:
  pdf_document:
    latex_engine: xelatex
knit: (function(inputFile, encoding) {
        rmarkdown::render(inputFile, encoding = encoding, output_dir = "document_output")
      })
bibliography: references.bib
header-includes:
  \usepackage{textgreek}
---

**Author:** Justin P.F. Pomeranz^1,2,\*^, Jacques C. Finlay^3^, Akira Terui^1,\*^

^1^ Department of Biology, University of North Carolina at Greensboro; ^2^ Department of Environmental Sciences, Colorado Mesa University; ^3^ Department of Ecology, Evolution and Behavior, University of Minnesota

**\*Corresponding Author:** JPF Pomeranz, jfpomeranz\@gmail.com; A Terui, hanabi0111\@gmail.com

# Abstract

Understanding the drivers of food chain length in natural communities has intrigued ecologists since the publication of 'food cycles' by Elton in the early 20th century. Proposed drivers of food chain length have included extrinsic controls such as productivity, disturbance regime, and ecosystem size, as well as intrinsic factors including trophic omnivory. However, current theories have largely assumed simple, two-dimensional habitat architectures, and may not be adequate to predict food chain length in ecosystems which have a complex, branching structure. Here, we develop a spatially explicit theoretical model which provides an integrated framework for understanding variation in food chain length in branching networks. We show independent, positive influences of both ecosystem size and complexity on food chain length. However, these effects were contingent upon other proposed extrinsic and intrinsic drivers such as disturbance regime, productivity, and trophic omnivory. Our results show that ecosystem complexity is an important driver of food chain length that may explain enigmatic variation can reconcile inconsistent results from empirical studies of food chain length in riverbranching ecosystems. 

**Keywords:** Food chain length, omnivory, branching networks, fractals, intraguild predation, complex network architecture

# Introduction

# Methods

## **Network Generation**

We generated branching networks as connected habitat patches (**Figure 1A**). The geometric arrangement of networks was controlled by two parameters: ecosystem size, the number of patches ($N_{p}$); and ecosystem complexity, branching probability ($P_{b}$). Habitat patches were assigned to be a confluence (or upstream terminal patch) with probability $P_{b}$, or an in-branch patch with probability $1-P_{b}$. Branches (tributaries) are a series of connected patches between confluences (or upstream terminal patches). The number of patches within branch $q$, $n_{p,q}$, is a random variable drawn from a geometric distribution $n_{p,q} \sim Ge(P_{b})$ but conditional on $N_{p} = \sum_{q}^{N_{b}} n_{p,q}$ ($N_{b}$ is the number of branches in a network). Full details of the network generation process is described in @teruiEmergentDualScaling2021. For each ecological scenario described below, we generated 1000 networks across a gradient of ecosystem size and complexity by drawing $N_{p}$ and $P_{b}$ from uniform distributions as: $N_{p} \sim Unif(10, 150)$ and $P_{b} \sim Unif(0.01, 0.99)$ ($N_{p}$ was rounded to the nearest integer before running simulations). 

We simulated the spatial distribution of disturbance intensity (i.e., proportional mortality in the event of stochastic regional disturbance) as follows. A disturbance value, $m_{h}$, was assigned randomly to upstream terminal patch $h$ as $logit~m_{h} \sim Normal(logit~\mu_m, \sigma_{h}^2)$, where $\mu_m$ is the average of disturbance intensity at headwaters in an ordinary scale. The disturbance values propagate downstream through a spatial autoregressive process as $logit~m_{down} = logit~m_{up}+ \epsilon$, where $m_{down}$ and $m_{up}$ are the disturbance values at down- and upstream patches, and the local environmental noise at the downstream patch $\epsilon$ was drawn from $Normal(0, \sigma_{l}^2)$. This autoregressive process resembles natural disturbance regime, where flood or drought disturbance cascades downstream with some local variation along the channel. At confluence patches, the disturbance value takes a weighted mean based on the relative size of the two contributing branches, $Q$ (the number of upstream contributing patches): $logit~m_{down} = \omega~\{logit~m_{1,up} +\epsilon_1\}+(1-\omega)~\{logit~m_{2,up} +\epsilon_2\}$, where $m_{1,up}$ and $m_{2,up}$ are the disturbance values of upstream contributing tributaries, $\epsilon_1$ and $\epsilon_2$ are independent local noises, and $\omega$ the relative size of one tributary over another defined as $\omega = \frac{Q_{1}}{Q_{1} + Q_{2}}$. Thus, the larger tributary has a greater influence on the downstream environment, as observed in natural river networks [@bendaNetworkDynamicsHypothesis2004]. Disturbance value distributions had medians close to $m$ with long tails (**Figure 1B**). The low-magnitude patches can be viewed as refugia, which supply individuals to impacted sites in subsequent time steps.

We also mimicked the downstream increase of local carrying capacity [@teruiThreeEcologicalFactors2016; @carraraComplexInteractionDendritic2014; @rahelFishAssemblagesHabitat1991]. Carrying capacity in patch $x$, $K_x$, was assumed to increase as a power function of ecosystem area (i.e., watershed area) [@finlayStreamSizeHuman2011; @koenigEmergentProductivityRegimes2019]: 

```{=tex}
\begin{align}
K_{x} = K_{base}N_{p,up}^z
\end{align}
```
where $K_{base}$ is the carrying capacity at the upstream terminal patch, $N_{p,up}$ the number of patches upstream, and $z$ is the scaling exponent. We used $K_{base} = 100$ and $z = 0.54$ based on empirical relationships of gross primary production and watershed area [@finlayStreamSizeHuman2011]. 

## **Tri-trophic dynamic simulation model**

We employed a discrete-time model to describe tri-trophic dynamics in each habitat patch. A discrete model is suitable for organisms with predictable reproduction cycles, a common life-history for many lotic species including macroinvertebrates and fish. Our simulation model consists of three species communities; a basal species $B$ with positive logistic growth up to a carrying capacity, $K$; a primary consumer species or intraguild prey, $C$, which grows based on the consumption of $B$; and an intraguild predator $P$, which can consume both $B$ and $C$ (**Figure 1C**). In our model, the realized species abundance $A_{i,x}(t+1)$ for species i (either $B,C,~or~P$) at patch $x$ and time $t+1$ is expressed as a composite of within-patch trophic interactions, immigration, and emigration:

```{=tex}
\begin{align}
A_{i,x}(t+1) \sim Poisson(\bar{A}_{i,x}(t) + I_{i,x}(t) - E_{i,x}(t))
\end{align}
```
where $\bar{A}_{i,x}$ is the expected species abundance after within-patch trophic interactions, $I_{i,x}(t)$ the expected number of immigrants into patch $x$, and $E_{i,x}(t)$ the expected number of emigrants from patch $x$. The realized discrete number of individuals is drawn from a Poisson distribution to account for stochasticity in demographic and dispersal processes.

In each time step, internal dynamics occur first. The basal species is exposed to predation as well as other sources of mortality:

```{=tex}
\begin{align}
A_{B,x}'(t) = s_{0,B}\{1-z_{B,x}(t)\}A_{B,x}(t)
\end{align}
```
where $s_{0,i}$ is the background survival probability (density independent) and $z_{B,x}(t)$ the proportional mortality caused by predation. Subsequently, a density-dependent recruitment occurs:

```{=tex}
\begin{align}
\bar{A}_{B,x}(t) = \frac{r_{b}A_{B,x}'(t)}{1 + \frac{r_b - 1}{K_{x}}A_{B,x}'(t)}(1-\psi(t)~m_{x})
\end{align}
```
$r_b$ is the reproductive rate for survived individuals, $\psi(t)$ the random binary variable indicating the occurrence of regional disturbance (disturbance occurs if $\psi(t)=1$ otherwise $0$), and $m_x$ the proportional mortality caused by disturbance. $\psi(t)$ was drawn from a Bernoulli distribution with disturbance probability $p_m$. The predator-induced mortality $z_{B,x}(t)$ is determined as follows:

```{=tex}
\begin{equation}
z_{B,x}(t) = z_{BC,x}(t) + z_{BP,x}(t) =
\left\{
\begin{aligned}
&\frac{W_{BC,x}(t) + \delta_{x}(t) W_{BP,x}(t)}{A_{B,x}(t)} &&\text{if~$W_{BC,x}(t) + \delta_{x}(t) W_{BP,x}(t) < A_{B,x}(t)$}\\
&1 &&\text{if~$W_{BC,x}(t) + \delta_{x}(t) W_{BP,x}(t) > A_{B,x}(t)$}\\
\end{aligned}
\right.
\end{equation}
```
where $W_{ij,x}(t)$ is the total consumption of consumer $j$ on prey $i$ (number of individuals). We assumed the Holling Type-II functional response for predator-prey interactions:

```{=tex}
\begin{align}
W_{ij,x} = \frac{a_{ij}A_{i,x}A_{j,x}}{A_{j,x} + a_{ij}h_{ij}A_{i,x}}
\end{align}
```
$a_{ij}$ is the attack rate and $h_{ij}$ the handling time. The parameter $\delta_{x}(t)$ is the relative preference of intraguild predator $P$ to basal species $B$ over intraguild prey $C$. To be realistic, we assume that the preference parameter depends on the relative potential amount of energy obtained from each prey:

```{=tex}
\begin{align}
\delta_{x} = \frac{e_{BP} f_{BP}(A_{B,x})}{e_{BP} f_{BP}(A_{B,x}) + e_{CP} f_{CP}(A_{C,x})}
\end{align}
```
where $e_{ij}$ is the conversion efficiency from prey $i$ to consumer $j$, and $f_{ij}(A_{i,x}) = \frac{a_{ij}A_{i,x}}{1 + a_{ij}h_{ij}A_{i,x}}$. An analogous approach has been applied to a model with multiple prey choices [@shotanishijimaRolesAlternativePrey2014].

The intraguild prey $C$ is controlled by both prey availability and predation.

$$
\bar{A}_{C,x}(t) = e_{BC}s_{0,C}(1-z_{CP,x})z_{BC,x}A_{B,x}
$$

# Results

# Discussion
